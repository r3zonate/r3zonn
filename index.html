<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>r3zon</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Athiti:wght@200;300;400;500;600;700&family=Oxanium:wght@200..800&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0c1018;
  --accent: #00ff99;
  --secondary: #ff00cc;
  --muted: #a0a8c0;
  --glow: rgba(0, 255, 153, 0.7);
}
html, body {
  margin: 0;
  padding: 0;
  height: 100vh;
  width: 100%;
  background: var(--bg);
  /*font-family: 'Oxanium', sans-serif;*/
  font-family: 'Space Mono', monospace;
  color: var(--muted);
  overflow: hidden;
}
body {
  background: linear-gradient(135deg, #0c1018, #1c2638);
  position: relative;
}
header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background: linear-gradient(to bottom, rgba(17, 17, 17, 0.95), rgba(17, 17, 17, 0.85));
  padding: 15px 0;
  z-index: 50;
  text-align: center;
}
@keyframes headerGlow {
  0%, 100% { box-shadow: 0 4px 10px rgba(0, 255, 153, 0.3); }
  50% { box-shadow: 0 4px 15px rgba(0, 255, 153, 0.5); }
}
nav a {
  color: var(--accent);
  margin: 0 20px;
  text-decoration: none;
  font-weight: bold;
  /*font-family: 'Oxanium', sans-serif;*/
  font-family: 'Space Mono', monospace;
  font-size: 18px;
  transition: color 0.3s, transform 0.3s;
}
nav a:hover {
  color: #fff;
  text-shadow: 0 0 12px var(--glow);
  transform: translateY(-2px);
}
.circuit-bg {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;
  opacity: 0.25;
}
.countdown {
  text-align: center;
  padding: 20px;
  margin: 70px auto 10px;
  width: 90%;
  max-width: 800px;
  color: var(--accent);
  font-family: 'Oxanium', sans-serif;
  font-size: 32px;
  text-shadow: 0 0 10px var(--glow);
  animation: slideIn 0.8s ease-out;
}
.hub-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: calc(100vh - 70px - 10px - 70px);
  padding: 20px;
}
.terminal-box {
  background: rgba(15, 20, 30, 0.9);
  border-radius: 12px;
  width: 90%;
  max-width: 800px;
  padding: 30px;
  position: relative;
  z-index: 1;
  animation: bootUp 1.5s ease-out;
  margin-bottom: 10%;
}
@keyframes bootUp {
  from { opacity: 0; transform: translateY(50px); }
  to { opacity: 1; transform: translateY(0); }
}
.screen {
  flex: 1;
  overflow-y: auto;
  max-height: 400px;
  padding-bottom: 20px;
  color: var(--accent);
  font-size: 15px;
  line-height: 1.6;
  white-space: pre-wrap;
  animation: slideIn 0.8s ease-out;
}
@keyframes slideIn {
  from { transform: translateX(-40px); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}
.prompt {
  color: var(--secondary);
}
.cmd-line {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-top: 8px;
}
.cmd-input {
  flex: 1;
  border: none;
  outline: none;
  background: transparent;
  color: var(--accent);
  font-family: 'Oxanium', sans-serif;
  font-size: 14px;
}
.cmd-input::placeholder {
  color: var(--muted);
}
.hint {
  font-size: 14px;
  color: var(--secondary);
  text-align: center;
  margin-top: 25px;
  font-family: 'Athiti', sans-serif;
}
.typed-text {
  font-size: 15px;
  line-height: 1.6;
  color: var(--muted);
  white-space: pre-wrap;
  overflow: hidden;
  border-right: 2px solid var(--accent);
  animation: typing 2s steps(40, end), blink 0.5s step-end infinite;
}
@keyframes typing {
  from { width: 0; }
  to { width: 100%; }
}
@keyframes blink {
  from, to { border-color: transparent; }
  50% { border-color: var(--accent); }
}
@media (max-width: 768px) {
  .terminal-box {
    width: 80%;
    padding: 20px;
  }
  .countdown {
    margin: 60px auto 5px;
    font-size: 26px;
  }
  .hub-container {
    padding: 10px;
    margin-top: 0;
    height: auto;
    min-height: calc(100vh - 120px);
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
  }
  .screen {
    max-height: 300px;
    padding-bottom: 15px;
  }
  nav a {
    margin: 0 10px;
    font-size: 16px;
  }
}
span[lang="th"] {
  font-family: 'Athiti', sans-serif;
}
span[lang="en"] {
  font-family: 'Oxanium', sans-serif;
}
</style>
</head>
<body>
<header>
  <nav>
    <a href="index.html">Home</a>
    <a href="blog.html">Blog</a>
  </nav>
</header>

<canvas id="circuit" class="circuit-bg"></canvas>

<div class="countdown" id="countdown"></div>
<div class="hub-container">
  <div class="terminal-box">
    <div id="screen" class="screen"></div>
    <div class="cmd-line">
      <span class="prompt">> </span>
      <input id="cmd" class="cmd-input" placeholder="type command..." autocomplete="off" />
    </div>
    <div class="hint">Enter ↵ • ↑/↓ history</div>
  </div>
</div>

<script>
const canvas = document.getElementById('circuit');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

function drawCircuit() {
  ctx.strokeStyle = 'rgba(0, 255, 153, 0.3)';
  ctx.lineWidth = 1;
  ctx.beginPath();
  for (let i = 0; i < canvas.width; i += 50) {
    ctx.moveTo(i, 0);
    ctx.lineTo(i, canvas.height);
  }
  for (let i = 0; i < canvas.height; i += 50) {
    ctx.moveTo(0, i);
    ctx.lineTo(canvas.width, i);
  }
  ctx.stroke();
  ctx.fillStyle = 'rgba(0, 255, 153, 0.5)';
  for (let i = 0; i < 20; i++) {
    ctx.beginPath();
    ctx.arc(Math.random() * canvas.width, Math.random() * canvas.height, 3, 0, Math.PI * 2);
    ctx.fill();
  }
}

drawCircuit();

window.addEventListener('resize', () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  drawCircuit();
});

// Countdown logic
const startDate = new Date('2025-11-03T00:00:00+07:00');
const endDate = new Date('2026-11-02T23:59:59+07:00');
function updateCountdown() {
  const now = new Date();
  let daysLeft;
  
  if (now < startDate) {
    const diff = startDate - now;
    const totalSeconds = Math.floor(diff / 1000);
    const years = Math.floor(totalSeconds / (365 * 24 * 60 * 60));
    const months = Math.floor((totalSeconds % (365 * 24 * 60 * 60)) / (30 * 24 * 60 * 60));
    const days = Math.floor((totalSeconds % (30 * 24 * 60 * 60)) / (24 * 60 * 60));
    const hours = Math.floor((totalSeconds % (24 * 60 * 60)) / (60 * 60));
    const minutes = Math.floor((totalSeconds % (60 * 60)) / 60);
    const seconds = totalSeconds % 60;
    document.getElementById('countdown').innerHTML = `${years}Y ${months}M ${days}D ${hours}H ${minutes}m ${seconds}s<br>until service starts`;
    daysLeft = Math.ceil(diff / (1000 * 60 * 60 * 24));
  } else if (now <= endDate) {
    const diff = endDate - now;
    const totalSeconds = Math.floor(diff / 1000);
    const years = Math.floor(totalSeconds / (365 * 24 * 60 * 60));
    const months = Math.floor((totalSeconds % (365 * 24 * 60 * 60)) / (30 * 24 * 60 * 60));
    const days = Math.floor((totalSeconds % (30 * 24 * 60 * 60)) / (24 * 60 * 60));
    const hours = Math.floor((totalSeconds % (24 * 60 * 60)) / (60 * 60));
    const minutes = Math.floor((totalSeconds % (60 * 60)) / 60);
    const seconds = totalSeconds % 60;
    document.getElementById('countdown').textContent = `${years}Y ${months}M ${days}D ${hours}H ${minutes}m ${seconds}s<br>until return`;
    daysLeft = Math.floor(totalSeconds / (24 * 60 * 60));
  } else {
    document.getElementById('countdown').textContent = 'Service complete!';
    daysLeft = 0;
  }
  return daysLeft;
}
setInterval(updateCountdown, 1000);
let countdownDays = updateCountdown();

const screen = document.getElementById('screen');
const cmd = document.getElementById('cmd');
let history = [], pos = -1;
let dataLoaded = false;

function out(t) {
  const div = document.createElement('div');
  div.textContent = t;
  div.className = 'typed-text';
  screen.appendChild(div);
  screen.scrollTop = screen.scrollHeight;
}
function clearScr() { screen.innerHTML = ''; }

// Initialize DATA with fallback values
let DATA = {
  name: "r3zon",
  profile: "Loading profile data...",
  experience: "2025 Nov - Present: Pvt.\n2024 May - 2025 Oct: Penetration Tester",
  ctf: "",
  bugbounty: "",
  cve: "",
  certs: "CRTA (2025 Mar), CWES (2025 Jan)",
  profiles: ""
};

// Function to initialize terminal after data load
function initTerminal() {
  clearScr();
  out("$ whoami");
  out(DATA.name);
  out("Type 'help' to see commands");
  dataLoaded = true;
}

// Function to fetch and process data
function fetchData() {
  console.log('Attempting to fetch static/data.json...');
  fetch('static/data.json')
    .then(response => {
      console.log('Fetch response status:', response.status);
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }
      return response.json();
    })
    .then(data => {
      console.log('Fetched data:', data);
      DATA = {
        name: data.name || DATA.name,
        profile: data.intro || DATA.profile,
        experience: Array.isArray(data.experience) ? data.experience.join('\n') : (data.experience || DATA.experience),
        ctf: Array.isArray(data.activities) ? data.activities.join('\n') : (data.activities || DATA.ctf),
        bugbounty: data.bugbounty || DATA.bugbounty,
        cve: data.cve || DATA.cve,
        certs: Array.isArray(data.certifications) ? data.certifications.join('\n') : (data.certifications || DATA.certs),
        profiles: Array.isArray(data.profiles) ? data.profiles.map(p => `${p.platform}: ${p.url}`).join('\n') : (data.profiles || DATA.profiles)
      };
      console.log('Updated DATA:', DATA);
      initTerminal();
    })
    .catch(error => {
      console.error('Fetch error:', error);
      out("Initializing with default data...");
      out(`Error loading static/data.json: ${error.message}`);
      out("Try running 'reload' to retry, or check console for details.");
      out("Using fallback data for now.");
      initTerminal();
    });
}

// Initial fetch
out("Booting up...");
out("Loading profile data...");
fetchData();

// Expose reload function
window.retryFetchData = function() {
  if (!dataLoaded) return out("Data not ready yet.");
  out("Reloading data...");
  fetchData();
};

const SECRET_COMMANDS = {
  '-h': () => out("Available secret commands: " + Object.keys(SECRET_COMMANDS).map(k => k === '-h' ? '-h' : `--${k}`).join(', ')),
  'miss-you': () => out("Miss you too!"),
  'stay-strong': () => out("Always."),
  'countdown': () => {
    const now = new Date();
    if (now < startDate) {
      out(`${countdownDays} days until service starts.`);
    } else {
      out(`${countdownDays} days until return.`);
    }
  },
  'hope': () => out("Hope never dies."),
  'hungry': () => out("Always hungry, always eating."),
  'tired': () => out("Soldier mode: ON."),
  'motivation': () => out("Pain is temporary, pride is forever."),
  'friend': () => out("You're never forgotten."),
  'dream': () => out("Still dreaming of freedom."),
  'mission': () => out("Survive and return."),
  'smile': () => out("Smiling through it."),
  'love': () => out("Love never expires."),
  'future': () => out("Better days loading..."),
  'timeout': () => out("Resting, don't worry."),
  'return': () => out("I'll be back."),
  'ping': () => out("Pong! Still connected."),
  'safe': () => out("Yes, safe and sound."),
  'hello': () => out("Reporting for duty!"),
  '404': () => out("Freedom not found."),
  'sudo': () => out("Permission granted: survive."),
  'install': () => out("Installing patience… 99.9%."),
  'uninstall': () => out("Can't uninstall friendship."),
  'readme': () => out("Just miss me sometimes."),
  'whoami': () => out("Just your friend in uniform."),
  'id': () => out("Soldier #1 (in your heart)."),
  'key': () => out("You are the master key."),
  'compass': () => out("Always pointing home."),
  'flag': () => out("flag{i_10v3_y0u!}"),
  'unlock': () => {
    const now = new Date();
    if (now < startDate) {
      out(`Service starts in ${countdownDays} days.`);
    } else {
      out(`Freedom unlocked in ${countdownDays} days.`);
    }
  },
  'easteregg': () => out("Secret message: I'm fine."),
  'cheatcode': () => out("↑↑↓↓←→←→BA = miss you."),
  'midnight': () => out("Sleepless but surviving."),
  'star': () => out("Guiding light found. It's you hahaha.."),
  'galaxy': () => out("You're my universe."),
  'connection': () => out("Stable, even across distance."),
  'wru': () => out("I'm always here!"),
  'endgame': () => out("Return home: mission complete.")
};

const CMD = {
  help: () => out("Commands: whoami, profile, experience, ctf, bugbounty, cve, certs, profiles, clear, reload, secret [-h]"),
  whoami: () => out(DATA.name),
  profile: () => out(DATA.profile),
  experience: () => out(DATA.experience),
  ctf: () => out(DATA.ctf),
  bugbounty: () => out(DATA.bugbounty),
  cve: () => out(DATA.cve),
  certs: () => out(DATA.certs),
  profiles: () => out(DATA.profiles || "No profiles available"),
  clear: () => clearScr(),
  reload: () => window.retryFetchData(),
  secret: (args) => {
    if (!args || args === '-h') {
      SECRET_COMMANDS['-h']();
    } else if (SECRET_COMMANDS[args]) {
      SECRET_COMMANDS[args]();
    } else {
      out(`secret: invalid option -- '${args}'`);
    }
  }
};

cmd.addEventListener("keydown", e => {
  if (e.key === "Enter") {
    const v = cmd.value.trim();
    if (!v) return;
    out("> " + v);
    const [command, ...args] = v.split(' ');
    if (command === 'secret') {
      CMD.secret(args[0]?.replace('--', ''));
    } else if (CMD[command]) {
      CMD[command]();
    } else {
      out("command not found");
    }
    history.push(v);
    pos = history.length;
    cmd.value = "";
  }
  if (e.key === "ArrowUp") {
    pos = Math.max(0, pos - 1);
    cmd.value = history[pos] || "";
  }
  if (e.key === "ArrowDown") {
    pos = Math.min(history.length, pos + 1);
    cmd.value = history[pos] || "";
  }
});
</script>
</body>
</html>
